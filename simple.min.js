// Simple.js 0.1.0
// http://simplejs.org

// A simplistic MV* JavaScript library.
// Simple may be freely distributed under the MIT license.
// (c) 2012 Kim Joar Bekkelund
(function(e,t,n){var r=e.Simple={},i={on:function(e,t,n){this._events().addListener(e,t,n)},off:function(e,t,n){typeof t=="undefined"?this._events().removeAllListeners(e):this._events().removeListener(e,t,n)},trigger:function(){var e=this._events();e.emit.apply(e,arguments)},_events:function(){return this.eventEmitter||(this.eventEmitter=new n),this.eventEmitter}};r.events=t.extend({},i);var s=r.View=function(e){this.el=e.el,this.delegateEvents(),this.initialize(e)};t.extend(s.prototype,{initialize:function(){},render:function(){},DOM:function(e){return this.el.find(e)},delegateEvents:function(){if(!this.events)return;for(var e in this.events){var n=this.events[e],r=t.proxy(this[n],this),i=e.match(/^(\w+)(:?\s+(.*))?$/),s=i[1],o=i[2];this.el.on(s,o,r)}}});var o=r.Model=function(e){this.attributes=e||{},this.initialize(e)};t.extend(o.prototype,i,{initialize:function(){},fetch:function(e){this._performRequest("fetch",this,e||{},{})},save:function(e){this._performRequest("save",this,e||{},{type:"POST",data:JSON.stringify(this.attributes),contentType:"application/json"})},_performRequest:function(e,n,r,i){this.trigger(e+":started");var s={url:n.url,dataType:r.dataType||n.dataType||"json",success:function(t){n.attrs(t),typeof r.success!="undefined"?r.success(t):n.trigger(e+":finished")},error:function(t,i){typeof r.error!="undefined"?r.error():n.trigger(e+":error",i)}};t.ajax(t.extend(s,i))},attr:function(e,t){if(typeof t=="undefined")return this.attributes[e];this.attributes[e]=t},attrs:function(e){if(typeof e=="undefined")return t.extend({},this.attributes);t.extend(this.attributes,e)}}),s.extend=o.extend=function(e){var n=this,r=function(){n.apply(this,arguments)};return r.prototype=Object.create(n.prototype),t.extend(r.prototype,e),r.extend=n.extend,r}})(this,jQuery,EventEmitter);
